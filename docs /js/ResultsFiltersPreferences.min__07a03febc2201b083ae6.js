webpackJsonpCoveo__temporary([18,59,60],{102:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(0);n(393);var r=n(3),s=function(){function e(e,t){var n=this;this.labelElement=i.$$("span",{className:"coveo-form-group-label"}),this.labelElement.text(t),this.element=i.$$("fieldset",{className:"coveo-form-group"},this.labelElement),o.each(e,function(e){n.element.append(e.build())})}return e.doExport=function(){r.exportGlobally({FormGroup:e})},e.prototype.build=function(){return this.element.el},e}();t.FormGroup=s},14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(){function e(){}return e.addClassToSVGInContainer=function(t,n){var i=t.querySelector("svg");i.setAttribute("class",""+e.getClass(i)+n)},e.removeClassFromSVGInContainer=function(t,n){var i=t.querySelector("svg");i.setAttribute("class",e.getClass(i).replace(n,""))},e.addStyleToSVGInContainer=function(e,t){var n=e.querySelector("svg");i.each(t,function(e,t){n.style[t]=e})},e.getClass=function(e){var t=e.getAttribute("class");return t?t+" ":""},e}();t.SVGDom=o},143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(0),r=n(7);n(401);var s=n(4),c=n(3),a=function(){function e(e,t,n){void 0===e&&(e=function(e){}),this.onChange=e,this.options=t,this.label=n,this.buildContent()}return e.doExport=function(){c.exportGlobally({MultiSelect:e})},e.prototype.build=function(){return this.element},e.prototype.getElement=function(){return this.element},e.prototype.getValue=function(){return o.chain(this.element.options).toArray().filter(function(e){return e.selected}).map(function(e){return e.value}).value()},e.prototype.getUnselectedValues=function(){return o.chain(this.element.options).toArray().filter(function(e){return!e.selected}).map(function(e){return e.value}).value()},e.prototype.setValue=function(e){var t=this.getValue(),n=o.partition(o.toArray(this.element.options),function(e){return o.contains(t,e.value)}),r=o.partition(o.toArray(this.element.options),function(t){return o.contains(e,t.value)});o.each(r[0],function(e){return e.selected=!0}),o.each(r[1],function(e){return e.selected=!1});var c=!1;s.Utils.arrayEqual(n[0],r[0],!1)||(c=!0),s.Utils.arrayEqual(n[1],r[1],!1)||(c=!0),c&&i.$$(this.element).trigger("change")},e.prototype.reset=function(){var e=this.getValue();this.element.selectedIndex=-1,s.Utils.isEmptyArray(e)||i.$$(this.element).trigger("change")},e.prototype.buildContent=function(){var e=this;this.element=i.$$("select",{className:"mdc-multi-select mdl-list",multiple:"",size:this.options.length.toString()}).el;var t=i.$$("optgroup",{className:"mdc-list-group",label:this.label}),n=o.map(this.options,function(e){return i.$$("option",{value:e,className:"mdc-list-item"},r.l(e))});o.each(n,function(e){return t.append(e.el)}),this.element.appendChild(t.el),i.$$(this.element).on("change",function(){return e.onChange(e)})},e}();t.MultiSelect=a},17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),o=n(30),r=n(1);n(371);var s=function(){function e(){this.logger=new i.Logger(this)}return e.prototype.withOwner=function(e){return this.eventOwner=e,this},e.prototype.withElement=function(e){return e instanceof HTMLElement?this.element=r.$$(e):this.element=e,this},e.prototype.withLabel=function(e){return this.label=e,this},e.prototype.withTitle=function(e){return this.title=e,this},e.prototype.withSelectAction=function(e){return this.clickAction=e,this.enterKeyboardAction=e,this},e.prototype.withClickAction=function(e){return this.clickAction=e,this},e.prototype.withEnterKeyboardAction=function(e){return this.enterKeyboardAction=e,this},e.prototype.withFocusAndMouseEnterAction=function(e){return this.focusAction=e,this.mouseenterAction=e,this},e.prototype.withFocusAction=function(e){return this.focusAction=e,this},e.prototype.withMouseEnterAction=function(e){return this.mouseenterAction=e,this},e.prototype.withBlurAndMouseLeaveAction=function(e){return this.mouseleaveAction=e,this.blurAction=e,this},e.prototype.withMouseLeaveAction=function(e){return this.mouseleaveAction=e,this},e.prototype.withBlurAction=function(e){return this.blurAction=e,this},e.prototype.build=function(){return this.element||(this.element=r.$$("div")),this.ensureCorrectRole(),this.ensureCorrectLabel(),this.ensureTitle(),this.ensureSelectAction(),this.ensureUnselectAction(),this.ensureMouseenterAndFocusAction(),this.ensureMouseleaveAndBlurAction(),this.ensureDifferentiationBetweenKeyboardAndMouseFocus(),this},e.prototype.ensureDifferentiationBetweenKeyboardAndMouseFocus=function(){var e=this,t="coveo-accessible-button-pressed",n="coveo-accessible-button-focused";r.$$(this.element).addClass("coveo-accessible-button"),r.$$(this.element).on("mousedown",function(){r.$$(e.element).addClass(t),r.$$(e.element).removeClass(n)}),r.$$(this.element).on("mouseup",function(){return r.$$(e.element).removeClass(t)}),r.$$(this.element).on("focus",function(){r.$$(e.element).hasClass(t)||r.$$(e.element).addClass(n)}),r.$$(this.element).on("blur",function(){return r.$$(e.element).removeClass(n)})},e.prototype.ensureCorrectRole=function(){this.element.getAttribute("role")||this.element.setAttribute("role","button")},e.prototype.ensureCorrectLabel=function(){if(!this.label)return void this.logger.error("Missing label to create an accessible button !");this.element.setAttribute("aria-label",this.label)},e.prototype.ensureTitle=function(){this.title&&this.element.setAttribute("title",this.title)},e.prototype.ensureTabIndex=function(){this.element.setAttribute("tabindex","0")},e.prototype.ensureSelectAction=function(){var e=this;this.enterKeyboardAction&&(this.ensureTabIndex(),this.bindEvent("keyup",o.KeyboardUtils.keypressAction(o.KEYBOARD.ENTER,function(t){return e.enterKeyboardAction(t)}))),this.clickAction&&this.bindEvent("click",this.clickAction)},e.prototype.ensureUnselectAction=function(){this.blurAction&&this.bindEvent("blur",this.blurAction),this.mouseleaveAction&&this.bindEvent("mouseleave",this.mouseleaveAction)},e.prototype.ensureMouseenterAndFocusAction=function(){this.mouseenterAction&&this.bindEvent("mouseenter",this.mouseenterAction),this.focusAction&&this.bindEvent("focus",this.focusAction)},e.prototype.ensureMouseleaveAndBlurAction=function(){this.mouseleaveAction&&this.bindEvent("mouseleave",this.mouseleaveAction),this.blurAction&&this.bindEvent("blur",this.blurAction)},e.prototype.bindEvent=function(e,t){this.eventOwner?this.eventOwner.on(this.element,e,t):r.$$(this.element).on(e,t)},e}();t.AccessibleButton=s},215:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),r=n(8),s=n(38),c=n(16),a=n(72),l=n(15),u=n(10),d=n(12),p=n(37),h=n(9),f=n(2),v=n(7),m=n(4),b=n(17),y=n(1),A=n(0),$=n(3);n(477);var C=n(58),F=n(50),g=n(143),x=n(102),E=n(13),I=n(14),T=function(e){function t(n,i,a){var u=e.call(this,n,t.ID,a)||this;return u.element=n,u.options=i,u.bindings=a,u.preferencePanelCheckboxInput={},u.options=r.ComponentOptions.initComponentOptions(n,t,i),u.preferencePanel=y.$$(u.element).closest(o.Component.computeCssClassNameForType("PreferencesPanel")),u.preferencePanel?(u.preferencePanelLocalStorage=new s.LocalStorageUtils(t.ID),u.mergeLocalPreferencesWithStaticPreferences(),u.bindPreferencePanelEvent(),u.bindBreadcrumbEvent(),u.bindQueryEvent(),u.bind.oneRootElement(c.InitializationEvents.afterComponentsInitialization,function(){return u.createDom()}),u.bind.oneQueryState(l.MODEL_EVENTS.CHANGE_ONE,d.QUERY_STATE_ATTRIBUTES.T,function(){return u.fromPreferencesToCheckboxInput()}),u):(u.logger.warn('Cannot instantiate ResultsFilterPreferences, as there is no "CoveoPreferencesPanel" in your page !'),u)}return i(t,e),t.prototype.createDom=function(){this.container=new x.FormGroup([],v.l("ResultsFilteringExpression")).build(),this.element.appendChild(this.container),this.buildCheckboxesInput(),this.options.showAdvancedFilters&&this.buildAdvancedFilters()},t.prototype.save=function(){this.fromCheckboxInputToPreferences();var e=A.omit(this.preferences,"tab");this.logger.info("Saving preferences",e),this.preferencePanelLocalStorage.save(e)},t.prototype.exitWithoutSave=function(){this.fromPreferencesToCheckboxInput(),this.hideAdvancedFilterBuilder()},t.prototype.bindPreferencePanelEvent=function(){var e=this;this.bind.on(this.preferencePanel,a.PreferencesPanelEvents.savePreferences,function(){return e.save()}),this.bind.on(this.preferencePanel,a.PreferencesPanelEvents.exitPreferencesWithoutSave,function(){return e.exitWithoutSave()})},t.prototype.bindBreadcrumbEvent=function(){var e=this;this.options.includeInBreadcrumb&&(this.bind.onRootElement(p.BreadcrumbEvents.populateBreadcrumb,function(t){return e.handlePopulateBreadcrumb(t)}),this.bind.onRootElement(p.BreadcrumbEvents.clearBreadcrumb,function(){return e.handleClearBreadcrumb()}))},t.prototype.bindQueryEvent=function(){var e=this;this.bind.onRootElement(u.QueryEvents.buildingQuery,function(t){return e.handleBuildingQuery(t)})},t.prototype.handleBuildingQuery=function(e){A.each(this.getActiveFilters(),function(t){m.Utils.isNonEmptyString(t.expression)&&e.queryBuilder.advancedExpression.add(t.expression)})},t.prototype.handlePopulateBreadcrumb=function(e){var t=this.getActiveFilters();if(m.Utils.isNonEmptyArray(t)){var n=y.$$("div",{className:"coveo-results-filter-preferences-breadcrumb"}),i=y.$$("span",{className:"coveo-title"});i.text(v.l("FiltersInYourPreferences")+":"),n.el.appendChild(i.el);var o=y.$$("span",{className:"coveo-values"});n.el.appendChild(o.el);for(var r=0;r<t.length;r++)o.el.appendChild(this.buildBreadcrumb(t[r]));e.breadcrumbs.push({element:n.el})}},t.prototype.handleClearBreadcrumb=function(){this.isFullBreadcrumbClear=!0,A.each(this.getActiveFilters(),function(e){e.selected=!1}),this.fromPreferencesToCheckboxInput(),this.isFullBreadcrumbClear=!1},t.prototype.buildAdvancedFilters=function(){var e=this;this.advancedFilters=y.$$("div",{className:"coveo-advanced-filters"},v.l("Create")).el,this.buildAdvancedFilterInput(),this.buildAdvancedFilterFormValidate(),this.advancedFiltersBuilder=y.$$("div",{className:"coveo-advanced-filters-builder"}).el,this.advancedFiltersBuilder.appendChild(this.advancedFilterFormValidate),y.$$(this.advancedFilters).on("click",function(){return e.openAdvancedFilterSectionOrSaveFilters()});var t=y.$$("a",{href:"http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10006",className:"coveo-online-help"},"?"),n=y.$$(this.container).find(".coveo-form-group-label");t.insertAfter(n),y.$$(this.advancedFilters).insertAfter(n),this.container.appendChild(this.advancedFiltersBuilder)},t.prototype.buildAdvancedFilterInput=function(){this.advancedFiltersTextInputCaption=new F.TextInput(function(){},v.l("Caption")),this.advancedFiltersTextInputCaption.getInput().setAttribute("required",""),this.advancedFiltersTextInputExpression=new F.TextInput(function(){},v.l("Expression")),this.advancedFiltersTextInputExpression.getInput().setAttribute("required",""),this.advancedFiltersTabSelect=new g.MultiSelect(function(){},this.getAllTabs(),v.l("Tab"))},t.prototype.buildAdvancedFilterFormValidate=function(){var e=this;this.advancedFilterFormValidate=y.$$("form").el;var t=y.$$("input",{type:"submit"}),n=y.$$("span",{className:"coveo-save"},E.SVGIcons.icons.checkboxHookExclusionMore);I.SVGDom.addClassToSVGInContainer(n.el,"coveo-save-svg");var i=y.$$("span",{className:"coveo-close"},E.SVGIcons.icons.checkboxHookExclusionMore);I.SVGDom.addClassToSVGInContainer(i.el,"coveo-close-svg");var o=y.$$("div",{className:"coveo-choice-container coveo-close-and-save"});o.el.appendChild(n.el),o.el.appendChild(i.el);var r=this.advancedFiltersTextInputCaption.build();y.$$(r).addClass("coveo-caption");var s=this.advancedFiltersTabSelect.build();y.$$(s).addClass("coveo-tab");var c=this.advancedFiltersTextInputExpression.build();y.$$(c).addClass("coveo-expression"),A.each([r,c,s,o.el,t.el],function(t){e.advancedFilterFormValidate.appendChild(t)}),n.on("click",function(){t.el.click()}),i.on("click",function(){e.hideAdvancedFilterBuilder()}),y.$$(this.advancedFilterFormValidate).on("submit",function(t){return e.validateAndSaveAdvancedFilter(t)})},t.prototype.getAllTabs=function(){var e=o.Component.getComponentRef("Tab");if(e){var t=y.$$(this.root).findAll("."+o.Component.computeCssClassName(e));return A.map(t,function(e){return o.Component.get(e).options.id})}return[]},t.prototype.getPreferencesBoxInputToBuild=function(){return A.map(this.preferences,function(e){return{label:e.caption,tab:e.tab,expression:e.expression}})},t.prototype.buildCheckboxesInput=function(){var e=this;void 0!=this.preferenceContainer&&this.preferenceContainer.remove();var t=this.getPreferencesBoxInputToBuild();m.Utils.isNonEmptyArray(t)&&(this.preferenceContainer=y.$$("div",{className:"coveo-choices-container"}).el,A.each(t,function(t){var n=new C.Checkbox(function(t){e.save();var n=e.preferences[t.getValue()];e.queryController.firstQuery||e.isFullBreadcrumbClear||(e.fromFilterToAnalyticsEvent(n,n.selected?"selected":"unselected"),e.queryController.executeQuery({closeModalBox:!1}))},t.label);y.$$(n.build()).addClass("coveo-choice-container"),e.preferencePanelCheckboxInput[t.label]=n,e.preferenceContainer.appendChild(n.getElement())}),A.each(y.$$(this.preferenceContainer).findAll(".coveo-choice-container"),function(e){e.appendChild(y.$$("div",{className:"coveo-section coveo-section-edit-delete"}).el)}),y.$$(this.container).append(this.preferenceContainer),this.buildEditAdvancedFilter(),this.buildDeleteAdvancedFilter(),this.fromPreferencesToCheckboxInput())},t.prototype.buildDeleteAdvancedFilter=function(){var e=this;A.each(this.preferences,function(t){if(t.custom){var n=y.$$("span",{className:"coveo-delete"},E.SVGIcons.icons.checkboxHookExclusionMore).el;I.SVGDom.addClassToSVGInContainer(n,"coveo-delete-svg");var i=e.getFilterElementByCaption(t.caption);y.$$(i).find(".coveo-section-edit-delete").appendChild(n),y.$$(n).on("click",function(){return e.confirmDelete(t,i)})}})},t.prototype.buildEditAdvancedFilter=function(){var e=this;A.each(this.preferences,function(t){if(t.custom){var n=y.$$("span",{className:"coveo-edit"},E.SVGIcons.icons.edit);I.SVGDom.addClassToSVGInContainer(n.el,"coveo-edit-svg");var i=e.getFilterElementByCaption(t.caption);y.$$(i).find(".coveo-section-edit-delete").appendChild(n.el),n.on("click",function(){return e.editElement(t,i)})}})},t.prototype.buildBreadcrumb=function(e){var t=this,n=y.$$("span",{className:"coveo-value"}),i=y.$$("span",{className:"coveo-caption"});i.text(e.caption),n.el.appendChild(i.el);var o=y.$$("span",{className:"coveo-clear"},E.SVGIcons.icons.checkboxHookExclusionMore);I.SVGDom.addClassToSVGInContainer(o.el,"coveo-clear-svg"),n.el.appendChild(o.el);var r=function(){e.selected=!1,t.fromFilterToAnalyticsEvent(e,"cleared from breadcrumb"),t.fromPreferencesToCheckboxInput()};return(new b.AccessibleButton).withElement(n).withLabel(v.l("RemoveFilterOn",e.caption)).withSelectAction(r).build(),n.el},t.prototype.confirmDelete=function(e,t){if(confirm(v.l("AreYouSureDeleteFilter",e.caption,e.expression))){var n=e.selected;this.deleteFilterPreference(e,t),n&&(this.fromFilterToAnalyticsEvent(e,"deleted"),this.queryController.executeQuery({closeModalBox:!1}))}},t.prototype.editElement=function(e,t){var n=this.preferences[e.caption].caption,i=this.preferences[e.caption].tab,o=this.preferences[e.caption].expression;this.deleteFilterPreference(e,t),this.openAdvancedFilterSectionOrSaveFilters(),this.populateEditSection({tab:i,caption:n,expression:o})},t.prototype.populateEditSection=function(e){void 0===e&&(e={tab:[""],caption:"",expression:""}),this.advancedFiltersTextInputCaption.setValue(e.caption),this.advancedFiltersTextInputExpression.setValue(e.expression),this.advancedFiltersTabSelect.setValue(e.tab)},t.prototype.deleteFilterPreference=function(e,t){this.preferencePanelLocalStorage.remove(e.caption),delete this.preferences[e.caption],y.$$(y.$$(t).closest(".coveo-choice-container")).detach()},t.prototype.openAdvancedFilterSectionOrSaveFilters=function(){y.$$(this.advancedFiltersBuilder).hasClass("coveo-active")?(y.$$(y.$$(this.advancedFilterFormValidate).find("input[type=submit]")).trigger("click"),this.hideAdvancedFilterBuilder()):(this.populateEditSection(),this.showAdvancedFilterBuilder())},t.prototype.validateAndSaveAdvancedFilter=function(e){e.preventDefault(),this.hideAdvancedFilterBuilder();var t=this.advancedFiltersTextInputCaption.getValue(),n=this.advancedFiltersTextInputExpression.getValue(),i=this.advancedFiltersTabSelect.getValue();this.preferences[t]={caption:t,custom:!0,expression:n,tab:i,selected:!0},this.buildCheckboxesInput(),this.save(),this.queryStateModel.set(d.QueryStateModel.attributesEnum.t,this.getActiveTab()),this.advancedFiltersTextInputCaption.reset(),this.advancedFiltersTextInputExpression.reset(),this.advancedFiltersTabSelect.reset(),this.container.appendChild(this.advancedFiltersBuilder),this.fromFilterToAnalyticsEvent(this.preferences[t],"saved"),this.queryController.executeQuery({closeModalBox:!1})},t.prototype.fromPreferencesToCheckboxInput=function(){var e=this;A.each(this.getActiveFilters(),function(t){e.preferencePanelCheckboxInput[t.caption].select()}),A.each(this.getInactiveFilters(),function(t){e.preferencePanelCheckboxInput[t.caption].reset()}),A.each(this.getDormantFilters(),function(t){e.preferencePanelCheckboxInput[t.caption].select()})},t.prototype.fromCheckboxInputToPreferences=function(){if(this.preferencePanelCheckboxInput){var e=A.map(A.filter(this.preferencePanelCheckboxInput,function(e){return e.isSelected()}),function(e){return e.getValue()});A.each(this.preferences,function(t){A.contains(e,t.caption)?t.selected=!0:t.selected=!1})}},t.prototype.getDormantFilters=function(){var e=this,t=this.getActiveTab();return A.filter(this.preferences,function(n){return n.selected&&!e.filterIsInActiveTab(n,t)})},t.prototype.getActiveFilters=function(){var e=this,t=this.getActiveTab();return A.filter(this.preferences,function(n){return n.selected&&e.filterIsInActiveTab(n,t)})},t.prototype.getInactiveFilters=function(){var e=this,t=this.getActiveTab();return A.filter(this.preferences,function(n){return!n.selected||!e.filterIsInActiveTab(n,t)})},t.prototype.getActiveTab=function(){return this.queryStateModel.get(d.QueryStateModel.attributesEnum.t)},t.prototype.filterIsInActiveTab=function(e,t){return e.tab=A.compact(e.tab),A.contains(e.tab,t)||m.Utils.isEmptyArray(e.tab)},t.prototype.getFilterElementByCaption=function(e){return y.$$(this.preferenceContainer).find("input[value='"+e+"']").parentElement},t.prototype.fromResultsFilterOptionToResultsPreferenceInterface=function(){var e={};return A.each(this.options.filters,function(t,n){e[n]={expression:t.expression,tab:t.tab,selected:!!t.selected&&t.selected,custom:!1,caption:n}}),e},t.prototype.mergeLocalPreferencesWithStaticPreferences=function(){var e=this.fromResultsFilterOptionToResultsPreferenceInterface(),t=this.preferencePanelLocalStorage.load(),n=A.filter(t,function(t){var n=t.custom,i=A.find(e,function(e){return e.caption==t.caption});return n||void 0!=i}),i={};A.each(n,function(e){i[e.caption]={expression:e.expression,tab:e.tab,selected:e.selected,custom:e.custom,caption:e.caption}}),this.preferences=m.Utils.extendDeep(e,i)},t.prototype.fromFilterToAnalyticsEvent=function(e,t){this.usageAnalytics.logSearchEvent(h.analyticsActionCauseList.customfiltersChange,{customFilterName:e.caption,customFilterExpression:e.expression,customFilterType:t})},t.prototype.enlargeModalBox=function(){var e=y.$$(document.body).find(".coveo-modal-container");e&&y.$$(e).addClass("coveo-mod-big")},t.prototype.shrinkModalBox=function(){var e=y.$$(document.body).find(".coveo-modal-container");e&&y.$$(e).removeClass("coveo-mod-big")},t.prototype.showAdvancedFilterBuilder=function(){this.advancedFiltersBuilder&&(y.$$(this.advancedFiltersBuilder).addClass("coveo-active"),this.enlargeModalBox())},t.prototype.hideAdvancedFilterBuilder=function(){this.advancedFiltersBuilder&&(y.$$(this.advancedFiltersBuilder).removeClass("coveo-active"),this.shrinkModalBox())},t.ID="ResultsFiltersPreferences",t.doExport=function(){$.exportGlobally({ResultsFiltersPreferences:t})},t.options={includeInBreadcrumb:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),showAdvancedFilters:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),filters:r.ComponentOptions.buildJsonOption()},t}(o.Component);t.ResultsFiltersPreferences=T,f.Initialization.registerAutoCreateComponent(T)},371:function(e,t){},393:function(e,t){},401:function(e,t){},477:function(e,t){}});