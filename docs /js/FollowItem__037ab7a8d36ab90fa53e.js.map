{"version":3,"sources":["./src/utils/SVGDom.ts","./src/rest/Subscription.ts","./src/ui/FollowItem/FollowItem.ts"],"names":[],"mappings":"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","file":"FollowItem__037ab7a8d36ab90fa53e.js","sourcesContent":["import { IStringMap } from '../rest/GenericParam';\nimport * as _ from 'underscore';\n\nexport class SVGDom {\n  public static addClassToSVGInContainer(svgContainer: HTMLElement, classToAdd: string) {\n    const svgElement = svgContainer.querySelector('svg');\n    svgElement.setAttribute('class', `${SVGDom.getClass(svgElement)}${classToAdd}`);\n  }\n\n  public static removeClassFromSVGInContainer(svgContainer: HTMLElement, classToRemove: string) {\n    const svgElement = svgContainer.querySelector('svg');\n    svgElement.setAttribute('class', SVGDom.getClass(svgElement).replace(classToRemove, ''));\n  }\n\n  public static addStyleToSVGInContainer(svgContainer: HTMLElement, styleToAdd: IStringMap<any>) {\n    const svgElement = svgContainer.querySelector('svg');\n    _.each(styleToAdd, (styleValue, styleKey) => {\n      svgElement.style[styleKey] = styleValue;\n    });\n  }\n\n  private static getClass(svgElement: SVGElement) {\n    const className = svgElement.getAttribute('class');\n    return className ? className + ' ' : '';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/SVGDom.ts","import { IQuery } from './Query';\n\nexport const SUBSCRIPTION_TYPE = {\n  followQuery: 'followQuery',\n  followDocument: 'followDocument'\n};\n\nexport interface ISearchAlertsEndpointOptions {\n  restUri: string;\n  accessToken?: string;\n  errorsAsSuccess?: boolean;\n}\n\nexport interface ISearchAlertsEndpointCallOptions {\n  type?: string;\n  page?: number;\n}\n\nexport interface ISearchAlertsEndpointSearchCallOptions {\n  documentIds: string[];\n}\n\n/**\n * Describe a subscription to the Coveo Search alerts service\n */\nexport interface ISubscription extends ISubscriptionRequest {\n  /**\n   * The id of the subscription\n   */\n  id: string;\n\n  /**\n   * The user associated with the subscription\n   */\n  user: ISubscriptionUser;\n}\n\n/**\n * Describe a user associated with a subscription to the Coveo Search alerts service\n */\nexport interface ISubscriptionUser {\n  /**\n   * The email of the user\n   */\n  email: string;\n\n  /**\n   * The token used to manage the alerts via email.\n   */\n  manageToken: string;\n}\n\n/**\n * Describe a request to subscribe to the Coveo Search alerts service\n */\nexport interface ISubscriptionRequest {\n  /**\n   * Type of subscription.<br/>\n   * Can be 'followQuery' or 'followDocument'\n   */\n  type: string;\n  /**\n   * Config of the subscription\n   */\n  typeConfig: ISubscriptionQueryRequest | ISubscriptionItemRequest;\n  /**\n   * Frequency of the alerts\n   */\n  frequency?: string;\n  /**\n   * The name that should be used by the API to identify this subscription\n   */\n  name: string;\n}\n\n/**\n * Describe a subscription to a single query\n */\nexport interface ISubscriptionQueryRequest {\n  /**\n   * Query to subscribe to\n   */\n  query: IQuery;\n  /**\n   * Which field on the result set represent the modification date for which you wish to receive alerts\n   */\n  modifiedDateField?: string;\n}\n\n/**\n * The `ISubscriptionItemRequest` interface describes a subscription to a single item (a result).\n */\nexport interface ISubscriptionItemRequest {\n  /**\n   * Contains the unique ID of the item to subscribe to.\n   */\n  id: string;\n\n  /**\n   * Contains the title of the item to subscribe to.\n   */\n  title: string;\n\n  /**\n   * Indicates which field contains the modification date of the item to subscribe to.\n   */\n  modifiedDateField?: string;\n\n  /**\n   * Contains a list of fields to monitor for the item to subscribe to.\n   */\n  watchedFields?: string[];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/rest/Subscription.ts","import { Component } from '../Base/Component';\nimport { ComponentOptions, IFieldOption } from '../Base/ComponentOptions';\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { Assert } from '../../misc/Assert';\nimport { SearchAlertsEvents, ISearchAlertsEventArgs, ISearchAlertsFailEventArgs } from '../../events/SearchAlertEvents';\nimport { ISubscription, ISubscriptionItemRequest, SUBSCRIPTION_TYPE, ISubscriptionRequest } from '../../rest/Subscription';\nimport { Initialization } from '../Base/Initialization';\nimport { l } from '../../strings/Strings';\nimport { $$, Dom } from '../../utils/Dom';\nimport {\n  analyticsActionCauseList,\n  IAnalyticsSearchAlertsFollowDocumentMeta,\n  IAnalyticsActionCause\n} from '../Analytics/AnalyticsActionListMeta';\nimport { QueryUtils } from '../../utils/QueryUtils';\nimport * as _ from 'underscore';\nimport { Utils } from '../../utils/Utils';\nimport { KeyboardUtils, KEYBOARD } from '../../utils/KeyboardUtils';\nimport { exportGlobally } from '../../GlobalExports';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { SVGDom } from '../../utils/SVGDom';\n\nexport interface IFollowItemOptions {\n  watchedFields?: IFieldOption[];\n  modifiedDateField?: string;\n}\n\n/**\n * The FollowItem component renders a widget that the end user can click to follow a particular item. A user following\n * an item receives email notifications when the item changes.\n *\n * **Note:**\n * > A {@link SearchAlerts} component must be present in the page for this component to work. It is also necessary to\n * > meet certain requirements to be able to use this component (see\n * > [Deploying Search Alerts on a Coveo JS Search Page](http://www.coveo.com/go?dest=cloudhelp&lcid=9&context=248)).\n *\n * This component is a result template component (see [Result Templates](https://developers.coveo.com/x/aIGfAQ)).\n */\nexport class FollowItem extends Component {\n  static ID = 'FollowItem';\n\n  static doExport = () => {\n    exportGlobally({\n      FollowItem: FollowItem\n    });\n  };\n\n  /**\n   * The options for the follow item component\n   * @componentOptions\n   */\n  static options: IFollowItemOptions = {\n    /**\n     * Specifies the {@link ISubscriptionItemRequest.watchedFields} to use when sending the\n     * {@link ISubscriptionItemRequest}.\n     *\n     * Default value is `undefined`.\n     */\n    watchedFields: ComponentOptions.buildFieldsOption(),\n\n    /**\n     * Specifies the {@link ISubscriptionItemRequest.modifiedDateField} to use when sending the\n     * {@link ISubscriptionItemRequest}.\n     *\n     * Default value is `undefined`.\n     */\n    modifiedDateField: ComponentOptions.buildStringOption()\n  };\n\n  private container: Dom;\n  private text: Dom;\n  private subscription: ISubscription;\n\n  /**\n   * Creates a new FollowItem component.\n   * @param element The HTMLElement on which to instantiate the component.\n   * @param options The options for the FollowItem component.\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\n   * automatically resolved (with a slower execution time)\n   * @param result The result to associate the component with.\n   */\n  constructor(\n    public element: HTMLElement,\n    public options?: IFollowItemOptions,\n    public bindings?: IResultsComponentBindings,\n    public result?: IQueryResult\n  ) {\n    super(element, FollowItem.ID, bindings);\n\n    this.options = ComponentOptions.initComponentOptions(element, FollowItem, options);\n\n    Assert.exists(this.result);\n\n    this.container = $$(this.element);\n    this.text = $$('span');\n    const icon = this.buildIcon();\n    const loadingIcon = this.buildLoadingIcon();\n    this.container.append(icon);\n    this.container.append(loadingIcon);\n    this.container.append(this.text.el);\n    this.container.on('click', () => this.toggleFollow());\n    this.container.setAttribute('tabindex', '0');\n    this.bind.on(this.container, 'keyup', KeyboardUtils.keypressAction(KEYBOARD.ENTER, () => this.toggleFollow()));\n\n    this.bind.onRootElement(SearchAlertsEvents.searchAlertsDeleted, (args: ISearchAlertsEventArgs) => this.handleSubscriptionDeleted(args));\n    this.bind.onRootElement(SearchAlertsEvents.searchAlertsCreated, (args: ISearchAlertsEventArgs) => this.handleSubscriptionCreated(args));\n\n    this.container.addClass('coveo-follow-item-loading');\n\n    this.updateIsFollowed();\n  }\n\n  public setFollowed(subscription: ISubscription) {\n    this.container.removeClass('coveo-follow-item-loading');\n    this.subscription = subscription;\n    this.container.addClass('coveo-follow-item-followed');\n    this.text.text(l('SearchAlerts_unFollowing'));\n  }\n\n  public setNotFollowed() {\n    this.container.removeClass('coveo-follow-item-loading');\n    this.subscription = <ISubscription>FollowItem.buildFollowRequest(this.getId(), this.result.title, this.options);\n    this.container.removeClass('coveo-follow-item-followed');\n    this.text.text(l('SearchAlerts_follow'));\n  }\n\n  /**\n   * Follows the item if not already following it. Stops following the item otherwise.\n   *\n   * Also logs the appropriate event in the usage analytics (either `searchAlertsFollowDocument` or\n   * `searchAlertsUnfollowDocument`).\n   */\n  public toggleFollow() {\n    if (!this.container.hasClass('coveo-follow-item-loading')) {\n      this.container.removeClass('coveo-follow-item-followed');\n      this.container.addClass('coveo-follow-item-loading');\n      if (this.subscription.id) {\n        this.logAnalyticsEvent(analyticsActionCauseList.searchAlertsUnfollowDocument);\n        this.queryController\n          .getEndpoint()\n          .deleteSubscription(this.subscription)\n          .then(() => {\n            const eventArgs: ISearchAlertsEventArgs = {\n              subscription: this.subscription,\n              dom: this.element\n            };\n            $$(this.root).trigger(SearchAlertsEvents.searchAlertsDeleted, eventArgs);\n          })\n          .catch(() => {\n            this.container.removeClass('coveo-follow-item-loading');\n            const eventArgs: ISearchAlertsFailEventArgs = {\n              dom: this.element\n            };\n            $$(this.root).trigger(SearchAlertsEvents.searchAlertsFail, eventArgs);\n          });\n      } else {\n        this.logAnalyticsEvent(analyticsActionCauseList.searchAlertsFollowDocument);\n        this.queryController\n          .getEndpoint()\n          .follow(this.subscription)\n          .then((subscription: ISubscription) => {\n            const eventArgs: ISearchAlertsEventArgs = {\n              subscription: subscription,\n              dom: this.element\n            };\n            $$(this.root).trigger(SearchAlertsEvents.searchAlertsCreated, eventArgs);\n          })\n          .catch(() => {\n            this.container.removeClass('coveo-follow-item-loading');\n            const eventArgs: ISearchAlertsFailEventArgs = {\n              dom: this.element\n            };\n            $$(this.root).trigger(SearchAlertsEvents.searchAlertsFail, eventArgs);\n          });\n      }\n    }\n  }\n\n  protected getText(): string {\n    return this.text.text();\n  }\n\n  private updateIsFollowed() {\n    this.queryController\n      .getEndpoint()\n      .listSubscriptions()\n      .then((subscriptions: ISubscription[]) => {\n        if (_.isArray(subscriptions)) {\n          const subscription: ISubscription = _.find(subscriptions, (subscription: ISubscription) => {\n            const typeConfig = <ISubscriptionItemRequest>subscription.typeConfig;\n            return typeConfig && typeConfig.id != null && typeConfig.id == this.getId();\n          });\n          if (subscription != null) {\n            this.setFollowed(subscription);\n          } else {\n            this.setNotFollowed();\n          }\n        } else {\n          this.remove();\n        }\n      })\n      .catch(() => {\n        this.remove();\n      });\n  }\n  private buildIcon(): HTMLElement {\n    const icon = $$('span', { className: 'coveo-follow-item-icon' }, SVGIcons.icons.dropdownFollowQuery);\n    SVGDom.addClassToSVGInContainer(icon.el, 'coveo-follow-item-icon-svg');\n    return icon.el;\n  }\n\n  private buildLoadingIcon(): HTMLElement {\n    const loadingIcon = $$('span', { className: 'coveo-follow-item-icon-loading' }, SVGIcons.icons.loading);\n    SVGDom.addClassToSVGInContainer(loadingIcon.el, 'coveo-follow-item-icon-loading-svg');\n    return loadingIcon.el;\n  }\n\n  private handleSubscriptionDeleted(args: ISearchAlertsEventArgs) {\n    if (args.subscription && args.subscription.type == SUBSCRIPTION_TYPE.followDocument) {\n      const typeConfig = <ISubscriptionItemRequest>args.subscription.typeConfig;\n      if (typeConfig.id == this.getId()) {\n        this.setNotFollowed();\n      }\n    }\n  }\n\n  private handleSubscriptionCreated(args: ISearchAlertsEventArgs) {\n    if (args.subscription && args.subscription.type == SUBSCRIPTION_TYPE.followDocument) {\n      const typeConfig = <ISubscriptionItemRequest>args.subscription.typeConfig;\n      if (typeConfig.id == this.getId()) {\n        this.setFollowed(args.subscription);\n      }\n    }\n  }\n\n  private remove() {\n    this.element.parentElement && this.element.parentElement.removeChild(this.element);\n  }\n\n  private getId() {\n    return Utils.getFieldValue(this.result, 'sysurihash') || Utils.getFieldValue(this.result, 'urihash');\n  }\n\n  private static buildFollowRequest(id: string, title: string, options: IFollowItemOptions): ISubscriptionRequest {\n    const typeCofig: ISubscriptionItemRequest = {\n      id: id,\n      title: title\n    };\n\n    if (options.modifiedDateField) {\n      typeCofig.modifiedDateField = options.modifiedDateField;\n    }\n\n    if (options.watchedFields) {\n      typeCofig.watchedFields = <string[]>options.watchedFields;\n    }\n\n    return {\n      type: SUBSCRIPTION_TYPE.followDocument,\n      typeConfig: typeCofig,\n      name: title\n    };\n  }\n\n  private logAnalyticsEvent(type: IAnalyticsActionCause) {\n    this.usageAnalytics.logCustomEvent<IAnalyticsSearchAlertsFollowDocumentMeta>(\n      type,\n      {\n        author: QueryUtils.getAuthor(this.result),\n        documentLanguage: QueryUtils.getLanguage(this.result),\n        documentSource: QueryUtils.getSource(this.result),\n        documentTitle: this.result.title,\n        contentIDValue: QueryUtils.getPermanentId(this.result).fieldValue,\n        contentIDKey: QueryUtils.getPermanentId(this.result).fieldUsed\n      },\n      this.element\n    );\n  }\n}\n\nInitialization.registerAutoCreateComponent(FollowItem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/FollowItem/FollowItem.ts"],"sourceRoot":""}